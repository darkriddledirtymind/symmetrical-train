<!-- absurd-generator-rich.html -->
<div id="absurd-generator-rich"></div>

<script>
class AbsurdGeneratorRich extends HTMLElement {
  constructor() {
    super();
    const shadow = this.attachShadow({ mode: 'open' });

    shadow.innerHTML = `
      <style>
        * { box-sizing: border-box; font-family: sans-serif; }
        .container { background: #1e1e2f; color: white; padding: 16px; border-radius: 12px; max-width: 700px; font-size: 14px; margin: auto; }
        button { background: #6366f1; color: white; border: none; padding: 10px 16px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; }
        button:disabled { opacity: 0.6; cursor: not-allowed; }
        input, select { width: 100%; margin-top: 4px; margin-bottom: 10px; padding: 6px 8px; border-radius: 6px; border: 1px solid #444; background: #2a2a3d; color: white; }
        label { display: block; margin-bottom: 6px; }
        .idea-card { background: #2a2a3d; border-radius: 10px; padding: 12px; margin-bottom: 12px; border: 1px solid #444; }
        .idea-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .idea-name { font-weight: bold; font-size: 1.2em; }
        .tagline { font-style: italic; color: #aaa; font-size: 0.9em; }
        .section { margin: 6px 0; padding: 6px; border-radius: 6px; background: #1f1f2a; }
        .section h4 { margin: 0 0 4px 0; font-size: 0.85em; color: #ffd700; }
        .pricing { display: flex; gap: 8px; margin-top: 6px; }
        .tier { flex: 1; background: #3a3a5a; text-align: center; padding: 4px; border-radius: 6px; font-size: 0.85em; }
        .tier.pro { border: 1px solid #6366f1; background: #4b4bb5; }
        .copy-btn { background: #22c55e; margin-top: 8px; }
      </style>
      <div class="container">
        <label>API Key: <input id="api-key" type="password" placeholder="–í—Å—Ç–∞–≤—Ç–µ —Å–≤—ñ–π –∫–ª—é—á" /></label>
        <label>–¢–µ–º–∞ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ): <input id="topic" placeholder="SleepTech, PetTech..." /></label>
        <label>–†—ñ–≤–µ–Ω—å –∞–±—Å—É—Ä–¥—É: 
          <select id="level">
            <option value="1">1 (Mild)</option>
            <option value="2" selected>2 (Wild)</option>
            <option value="3">3 (Insane)</option>
          </select>
        </label>
        <label>–ö—ñ–ª—å–∫—ñ—Å—Ç—å —ñ–¥–µ–π: 
          <select id="count">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
          </select>
        </label>
        <button id="generate-btn">–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –Ü–¥–µ—ó</button>
        <button id="copy-btn" class="copy-btn">üìã –ö–æ–ø—ñ—é–≤–∞—Ç–∏ –≤—Å—ñ —ñ–¥–µ—ó</button>
        <div id="ideas-container">–ù–∞—Ç–∏—Å–Ω–∏ –∫–Ω–æ–ø–∫—É, —â–æ–± –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —ñ–¥–µ—ó.</div>
      </div>
    `;
    this.shadow = shadow;
  }

  connectedCallback() {
    const btn = this.shadow.getElementById('generate-btn');
    const copyBtn = this.shadow.getElementById('copy-btn');
    const ideasContainer = this.shadow.getElementById('ideas-container');

    const renderIdeas = (ideas) => {
      ideasContainer.innerHTML = '';
      ideas.forEach(idea => {
        const card = document.createElement('div');
        card.className = 'idea-card';
        card.innerHTML = `
          <div class="idea-header">
            <div class="idea-name">${idea.name}</div>
            <div>Level ${idea.level || ''}</div>
          </div>
          <div class="tagline">"${idea.tagline}"</div>
          <div class="section"><h4>üéØ Problem</h4>${idea.problem}</div>
          <div class="section"><h4>‚ú® Solution</h4>${idea.solution}</div>
          <div class="section"><h4>üë• Audience</h4>${idea.audience}</div>
          <div class="section"><h4>üìä Stats</h4>${idea.stat}</div>
          <div class="section"><h4>üí∏ Funding</h4>$${(idea.funding/1000).toFixed(1)}M</div>
          <div class="section"><h4>üí∞ Pricing</h4>
            <div class="pricing">
              <div class="tier">Basic $${idea.pricing.basic}</div>
              <div class="tier pro">Pro $${idea.pricing.pro}</div>
              <div class="tier">Enterprise $${idea.pricing.enterprise}</div>
            </div>
          </div>
        `;
        ideasContainer.appendChild(card);
      });
    };

    btn.addEventListener('click', async () => {
      const API_KEY = this.shadow.getElementById('api-key').value.trim();
      if (!API_KEY) {
        ideasContainer.textContent = "–ë—É–¥—å –ª–∞—Å–∫–∞, –≤—Å—Ç–∞–≤—Ç–µ —Å–≤—ñ–π API –∫–ª—é—á!";
        return;
      }

      const topic = this.shadow.getElementById('topic').value;
      const level = this.shadow.getElementById('level').value;
      const count = this.shadow.getElementById('count').value;

      btn.disabled = true;
      ideasContainer.textContent = "–ì–µ–Ω–µ—Ä—É—î–º–æ —ñ–¥–µ—ó...";

      const SYSTEM_PROMPT = `
–¢–∏ - "–ê–±—Å—É—Ä–¥–û—Ç—Ä–æ–Ω 3000", –µ–∫—Å–ø–µ—Ä—Ç–Ω–∏–π AI-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞–±—Å–æ–ª—é—Ç–Ω–æ –±–µ–∑–≥–ª—É–∑–¥–∏—Ö,
–∞–ª–µ –ø–µ—Ä–µ–∫–æ–Ω–ª–∏–≤–æ –ø–æ–¥–∞–Ω–∏—Ö –±—ñ–∑–Ω–µ—Å-—ñ–¥–µ–π —É —Å—Ç–∏–ª—ñ –ö—Ä–µ–º–Ω—ñ—î–≤–æ—ó –¥–æ–ª–∏–Ω–∏.
JSON only.
`;

      const ideaSchema = {
        type: "ARRAY",
        items: {
          type: "OBJECT",
          properties: {
            name: { type: "STRING" },
            tagline: { type: "STRING" },
            problem: { type: "STRING" },
            solution: { type: "STRING" },
            audience: { type: "STRING" },
            pricing: {
              type: "OBJECT",
              properties: {
                basic: { type: "INTEGER" },
                pro: { type: "INTEGER" },
                enterprise: { type: "INTEGER" }
              }
            },
            stat: { type: "STRING" },
            funding: { type: "INTEGER" }
          }
        }
      };

      const payload = {
        contents: [{ parts: [{ text: `–ó–≥–µ–Ω–µ—Ä—É–π ${count} –∞–±—Å—É—Ä–¥–Ω–∏—Ö —Å—Ç–∞—Ä—Ç–∞–ø-—ñ–¥–µ–π. –¢–µ–º–∞: ${topic}. –†—ñ–≤–µ–Ω—å: ${level}.` }] }],
        systemInstruction: { parts: [{ text: SYSTEM_PROMPT }] },
        generationConfig: { responseMimeType: "application/json", responseSchema: ideaSchema }
      };

      try {
        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${API_KEY}`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        if (!response.ok) throw new Error("–ü–æ–º–∏–ª–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: " + response.status);

        const result = await response.json();
        const jsonString = result.candidates?.[0]?.content?.parts?.[0]?.text;
        if (!jsonString) throw new Error("–ú–æ–¥–µ–ª—å –ø–æ–≤–µ—Ä–Ω—É–ª–∞ –ø–æ—Ä–æ–∂–Ω—é –≤—ñ–¥–ø–æ–≤—ñ–¥—å.");

        const cleaned = jsonString.replace(/^```json\s*|```\s*$/g, '').trim();
        const ideas = JSON.parse(cleaned);

        renderIdeas(ideas);

      } catch(e) {
        ideasContainer.textContent = "–ü–æ–º–∏–ª–∫–∞: " + e.message;
      } finally {
        btn.disabled = false;
      }
    });

    copyBtn.addEventListener('click', () => {
      const text = ideasContainer.innerText;
      navigator.clipboard.writeText(text).then(() => alert("–Ü–¥–µ—ó —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ!"));
    });
  }
}

customElements.define('absurd-generator-rich', AbsurdGeneratorRich);
</script>

<absurd-generator-rich></absurd-generator-rich>
